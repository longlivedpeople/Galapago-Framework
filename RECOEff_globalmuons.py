##################################################################################################
#                                                                                                #    
#                                      ```...`                                                   #    
#                                   `......-::::.`...---.`                                       #    
#                                  ``     `.-::-.....---:::-`                                    #    
#                                           ..`      `.--:://-                                   #    
#                                     `//:`            .-:::/+:                                  #    
#                                    +m/`sy            `.-:://+`                                 #    
#                              `    :mMmdN/        .::.`.-:://+-                                 #    
#                   ``-//-----------odMMMs`      -yh:/m+.-:///+-                                 #    
#               `..--------/oyy/---::/+sh.      -mNd/omh-:://++.                                 #    
#             `.-------------:------::///:.     yNMMMMNs-:///+:                                  #    
#           `------------------------:::://:`   omNNNmy-:///+:`                                  #    
#          .--------........---------:::::/+/.  `+sys/-::/+++:`                                  #    
#         .---------.---------------:::::///++:..------::://+o+.                                 #    
#        .---------...-------------:::::://++/----------:::///+o-                                #    
#        -------------------------::::::////:---.-------::::///+o.                               #    
#       `:----------------------:::::::///:---..-------:::::///+o/                               #    
#       .:--------------------:::::://///:-------------::::////+o+             `.-               #    
#       `::---------------:::::::://////:------------::::::///+++/            ..-:               #    
#       `::::--------:::::::////////////-----------::::://///++++-           .--:/`  ``..        #    
#        -/:::::::::::://///////////////--------::::://////+++++/`          .--:/+...--/.        #    
#         :///::::://////++++++++++++++/-----::::///////++++++//.         `.---::----:/:         #    
#          :+//////++++++++++++++++++o+/-:::::///////++++++++/:`         `..-------:/+/`````.`   #    
#           ./++++ooooooooooooooooooo/:::::///+++++++++++++//-`         `.---------///-..--:-    #    
#            `-+osssso/+sssssssssso+/::://+++ooooooooo+++/:-`          `----------------://-     #    
#               .:+:.` `-+ossyyyysooo++++oosssssoooo++//+:.            ---------------:/+/.      #    
#                         `-/+osyyyyyysssyysssssoo++++++oso/.----.````.-------------://+/`       #    
#                             `..-://+++osysssssooosyso+ooossydhs+----------------:://++:        #    
#                                       `+ssssssssssyyyo+++++/:--------------::::////////-`      #    
#                   `                  -+osooooooooosshhs/:----..--------::://////++//:----.     #    
#           ..`    ...`               :ssooooossssssyyy+:------------::/++ooooooooooo+/:----.`   #    
#           .--..``-.--`              .oysssssssssshdo:----------::/++ossyhddhhdo....--------`   #    
#     ``    `:-.---:----`             .----------:+mh:------:://++oohhhdddddddddms`              #    
#    `.......-:----------.`          .-...```````..smy++//++ooooooooyddddddddddddmy`             #    
#      `.-------------------.`````..-/:--.....`````.:shhhdddho/::/+oohdddddhhhhhddms             #    
#         `-------....--------------/:-...````````````..----:/.` ``-/+hddddhhhddddmd:            #    
#           `.-----.--..-----------:/:-....````````````````..::``  `.:ommddhdddmmmmms            #    
#             `---------------::://++:--......``````````....--/:`````.:sdddmmmmmdddmh`           #    
#             .--------:://+++++//:-//:--.....................-/-````.-/yydhyyyhhhhdd`           #    
#           `..----:://///:--..``   :+::--------..............-//.```.-:sdhyyyyyhhhhd`           #    
#          ..--::://::-..-://+///:-`.o/::----.................-:+:.``..:+hyyyyyyhhhhs            #    
#         .-::-..`   `:+ooooooooooso/o+:::---------------------:++-....:/yyyyyyyyhhh:            #    
#          `        .syso+++++++oooosso+/::::::-----------::::::+s/-..--:shyyyyyhhys`            #    
#                `.../yysoooooo+oooossyso///::------------::://++yo:---:/ohyyyyhhys.             #    
#                :o+:`.oysoooooooooossyhhoo+:----------:::::://++dh+::::/+dhhhhhys.              #    
#                .ooo:``ohyssoooooosssyhhoooo+:------::::::////++ymo//::/+dhhddh/`               #    
#                 /sso:``ohyyssssssssyyhdysooooo/:::://++///++++shds+////+mddho-                 #    
#                  :sss/.`odhyyyyyyyyyyhdddyssooso///+oysooooosshNhso++//+hyo-                   #    
#                   -syy+-.sdhhhyyyyyyyyyyhhhyyssssoosyyysssyhdmNdysso++/ossso+/-.               #    
#                    `/syo:-sddhhhyyyyysssyyhhhhyyyysosssssossyyhyyssso+ossoo++//-               #    
#                      `+hy/-oddhhyyyyssssyyyhddddhh+  `/oosssssssssoo+ydhho/:-.`                #    
#                       :osso:+ddhhyyyssssyyyhddhhyo.   `/oosssssssssssyhhhhhhhhy+.              #    
#                        -sso+::yddhyyyyyyyyyhho `       `:+osssssssssyhsoshdhhhhddo-`           #    
#                         .oys/--odddhhhhyyhhhs.           .:osyyyyyyhsoooyhdhyssyhds/           #    
#                          `/yy+:-/dmdddhhhhyo.             `yhhhhhysoosyhddhsoosyyds-           #    
#                            .+ys+/+dmdddhy+.               `shyssoosyhdddhysooosyhdo-`          #    
#                              .+so:-/::-.                   `-+oshhhhhhyyssoooosyhd/-           #    
#                                ``                        .:+oooo++oooooooooooosyhh-.           #    
#                                                        `+oooo++++++++++++++ooosyho`            #    
#                                                        +ssooooo++++++++++++oosyhd/.            #    
#                                                       `yyysssoooooooo+++oooosyyhh-.            #    
#                                                        sdhhyyyssssssssssssyyyhhd+-.            #    
#                                                        .hmddddhhhhhhhhhhhhhddddo:-             #    
#                                                         `:ohddmmddddddddddhyso/::              #    
#                                                            -:/++ooooooo++//:--.`               #    
##################################################################################################
#                           ____       _                                                         #
#                          / ___| __ _| | __ _ _ __   __ _  __ _  ___                            #
#                         | |  _ / _` | |/ _` | '_ \ / _` |/ _` |/ _ \                           #
#                         | |_| | (_| | | (_| | |_) | (_| | (_| | (_) |                          # 
#                     _____\____|\__,_|_|\__,_| .__/ \__,_|\__, |\___/ _                         #  
#                    |  ___| __ __ _ _ __ ___ |_|____      |___/  _ __| | _                      #_
#                    | |_ | '__/ _` | '_ ` _ \ / _ \ \ /\ / / _ \| '__| |/ /                     #
#                    |  _|| | | (_| | | | | | |  __/\ V  V / (_) | |  |   <                      # 
#                    |_|  |_|  \__,_|_| |_| |_|\___| \_/\_/ \___/|_|  |_|\_\                     #
#                                                                                                # 
##################################################################################################

import ROOT as r
from   ROOT import gROOT, TCanvas, TFile, TGraphErrors, SetOwnership, TVector3
import math, sys, optparse, array, copy, os
import gc, inspect
import numpy as np

import include.Sample as Sample
import include.helper as helper
import include.Canvas as Canvas

####################################### CLASS DEFINITION #########################################

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'



################################# GLOBAL VARIABLES DEFINITION ####################################

runningfile = os.path.abspath(__file__)
WORKPATH = ''
for level in runningfile.split('/')[:-1]:
    WORKPATH += level
    WORKPATH += '/'

print('runningfile: ' + runningfile)

##################################### FUNCTION DEFINITION ########################################



if __name__ == "__main__":

    print bcolors.HEADER
    print "                                 ```.....`                              "        
    print "                               `.````.-:::-.-------.                    "        
    print "                              ``      .--.`````.--://-                  "
    print "                                   `   `        `-::://`                "
    print "                                `os/y:           .-::/+/                "
    print "                                yNdod+        ````-:://+`               "
    print "                 ``-/-..------.-hNMMs`     `oy/sy.-:://+.               "
    print "              `..------:+ss/--::/+sh.     `dNh/sN/-://+/`               "
    print "           `.-------------------::///.    /NMMMNm::///+-                "
    print "         `.---------------------:::://:`  -dmNNh/:///+-                 "
    print "        `--------.---.----------:::::/+/.``-++/:-://+o+.                "
    print "       `--------..--------------:::://++/---------:://++:               "
    print "       .----------------------::::::/++:----------::://+o:              "
    print "       ---------------------::::::://:---..------:::://++o`             "
    print "      `:-------------------::::::///:----.------::::://++o.             "
    print "      `::--------------::::::://///:-----------:::::///+++.             "
    print "       ::::------:::::::://////////----------:::::////+++/`             "
    print "       ./:::::::::::///////////////-------:::://////++++/-              "
    print "        -///////////++++++++++++++/----:::///////++++++/-               "
    print "         ./+///+++++ooooooooo+ooo+::::::///++++++++++//.                "
    print "          `-+ooosssooooosssssso+/:::///+++++oooo+++//-`                 "
    print "            `-+so/-.:+sssyyysso++///+oooooooooo++//-`                   "
    print "               ``    `.:+osyyyyysssssssssssoo++++oo+:`..```             "
    print "                         `.-:/+++oooyyysssooosso+ooosoyhyo/-.           "
    print "                                  ``+sssssssssyyso++++/:------::        "
    print "                                  -+oooooooooosyhy+:----.-------::      "
    print '########################################################################' 
    print '                  Starting IFCA-LLP analysis...                         '
    print '########################################################################' + bcolors.ENDC

    gROOT.ProcessLine('.L ' + WORKPATH + 'include/tdrstyle.C')
    gROOT.SetBatch(1)
    print('WORKPATH: ' + WORKPATH)
    r.setTDRStyle()

    ###########################
    ####   Parser object   ####
    ###########################
    parser = optparse.OptionParser(usage='usage: %prog [opts] FilenameWithSamples', version='%prog 1.0')
    parser.add_option('-t', '--tag', action='store', type=str, dest='tag', default='', help='Output tag')
    parser.add_option('-f', '--filename', action='store', type=str, dest='filename', default='', help='Path to file')
    (opts, args) = parser.parse_args()


    ##################################
    ####   Variable declaration   ####
    ##################################
    MAX_DELTAR = 0.2 



    #################################
    ####   TEfficiency binning   ####
    #################################
    #Lxy_bin = np.array([0.0, 0.025, 0.5, 1.0, 2.0, 4.0, 8.0, 12.0, 16.0, 20., 30., 40., 50., 60., 70., 90., 110.0])
    #Lxy_bin = np.linspace(0.0, 110.0, 51)
    Lxy_bin = np.linspace(0.0, 60.0, 30)
    Lxy_profbin = np.array([0.0, 1.0, 5.0, 10.0, 15.0, 20.0, 30.0, 40.0, 60.0, 80.0, 100.0])
    dxy_bin = np.linspace(0.0, 60.0, 30)
    Lxy_logbin = np.logspace(0.0, 3.0, 101)
    pt_bin = np.linspace(0.0, 300.0, 100)
    

    ######################################
    ####   Book TEfficiency objects   ####
    ######################################
    eff_IFCA_pt = r.TEfficiency("eff_IFCA_pt", ";Generated #mu p_{T} (GeV);Efficiency", len(pt_bin)-1, pt_bin)
    eff_IFCA_Lxy = r.TEfficiency("eff_IFCA_Lxy", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_bin)-1, Lxy_bin)
    eff_IFCA_eta = r.TEfficiency("eff_IFCA_eta", "; Generated #mu #eta;Efficiency", 51, -2.1, 2.1)

    eff_SA_pt = r.TEfficiency("eff_SA_pt", ";Generated #mu p_{T} (GeV);Efficiency", len(pt_bin)-1, pt_bin)
    eff_SA_Lxy = r.TEfficiency("eff_SA_Lxy", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_bin)-1, Lxy_bin)
    eff_SA_Lxy_log = r.TEfficiency("eff_SA_Lxy_log", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_logbin)-1, Lxy_logbin)
    eff_SA_dxy = r.TEfficiency("eff_SA_dxy", ";Generated #mu d_{xy} (cm);Efficiency", len(dxy_bin)-1, dxy_bin)
    eff_SA_eta = r.TEfficiency("eff_SA_eta", "; Generated #mu #eta;Efficiency", 51, -2.1, 2.1)
    eff_SA_dR = r.TEfficiency("eff_SA_dR", ";Generated #mu #DeltaR;Efficiency", 10, 0.0, 1.0)

    eff_DSA_pt = r.TEfficiency("eff_DSA_pt", ";Generated #mu p_{T} (GeV);Efficiency", len(pt_bin)-1, pt_bin)
    eff_DSA_Lxy = r.TEfficiency("eff_DSA_Lxy", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_bin)-1, Lxy_bin)
    eff_DSA_Lxy_log = r.TEfficiency("eff_DSA_Lxy_log", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_logbin)-1, Lxy_logbin)
    eff_DSA_dxy = r.TEfficiency("eff_DSA_dxy", ";Generated #mu d_{xy} (cm);Efficiency", len(dxy_bin)-1, dxy_bin)
    eff_DSA_eta = r.TEfficiency("eff_DSA_eta", "; Generated #mu #eta;Efficiency", 51, -2.1, 2.1)
    eff_DSA_dR = r.TEfficiency("eff_DSA_dR", ";Generated #mu #DeltaR;Efficiency", 10, 0.0, 1.0)

    eff_DGM_pt = r.TEfficiency("eff_DGM_pt", ";Generated #mu p_{T} (GeV);Efficiency", len(pt_bin)-1, pt_bin)
    eff_DGM_Lxy = r.TEfficiency("eff_DGM_Lxy", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_bin)-1, Lxy_bin)
    eff_DGM_Lxy_log = r.TEfficiency("eff_DGM_Lxy_log", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_logbin)-1, Lxy_logbin)
    eff_DGM_dxy = r.TEfficiency("eff_DGM_dxy", ";Generated #mu d_{xy} (cm);Efficiency", len(dxy_bin)-1, dxy_bin)
    eff_DGM_eta = r.TEfficiency("eff_DGM_eta", "; Generated #mu #eta;Efficiency", 51, -2.1, 2.1)


    eff_PATGlobal_pt = r.TEfficiency("eff_PATGlobal_pt", ";Generated #mu p_{T} (GeV);Efficiency", len(pt_bin)-1, pt_bin)
    eff_PATGlobal_Lxy = r.TEfficiency("eff_PATGlobal_Lxy", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_bin)-1, Lxy_bin)
    eff_PATGlobal_dxy = r.TEfficiency("eff_PATGlobal_dxy", ";Generated #mu d_{xy} (cm);Efficiency", len(dxy_bin)-1, dxy_bin)
    eff_PATGlobal_Lxy_log = r.TEfficiency("eff_PATGlobal_Lxy_log", ";Generated #mu L_{xy} (cm);Efficiency", len(Lxy_logbin)-1, Lxy_logbin)
    eff_PATGlobal_eta = r.TEfficiency("eff_PATGlobal_eta", "; Generated #mu #eta;Efficiency", 51, -2.1, 2.1)


    ####################################################
    ####   Book TEfficiency objects (2Dimensional)  ####
    ####################################################
    eff_SA_ptVSLxy = r.TEfficiency("eff_SA_ptVSLxy", ";Generated #mu L_{xy} (cm);Generated #mu p_{T} (GeV)", 20, 0, 60, 20, 0, 300)
    eff_RSA_ptVSLxy = r.TEfficiency("eff_RSA_ptVSLxy", ";Generated #mu L_{xy} (cm);Generated #mu p_{T} (GeV)", 20, 0, 60, 20, 0, 300)
    eff_DSA_ptVSLxy = r.TEfficiency("eff_DSA_ptVSLxy", ";Generated #mu L_{xy} (cm);Generated #mu p_{T} (GeV)", 20, 0, 60, 20, 0, 300)


    #####################################
    ####   Book Resolution objects   ####
    #####################################
    hist_IFCA_ptRes = r.TH1F("hist_IFCA_ptRes", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 60, 0.0, 2.0)
    hist_DGM_ptRes = r.TH1F("hist_DGM_ptRes", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 60, 0.0, 2.0)
    hist_DGM_ptRes_zoom = r.TH1F("hist_DGM_ptRes_zoom", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 51, 0.8, 1.2)
    hist_DGM_ptRes_bin1 = r.TH1F("hist_DGM_ptRes_bin1", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 51, 0.8, 1.2)
    hist_DGM_ptRes_bin2 = r.TH1F("hist_DGM_ptRes_bin2", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 51, 0.8, 1.2)
    hist_DGM_ptRes_bin3 = r.TH1F("hist_DGM_ptRes_bin3", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 51, 0.8, 1.2)
    hist_DGM_dxyRes_zoom = r.TH1F("hist_DGM_dxyRes_zoom", ";d_{xy}^{reco}/d_{xy}^{gen};Pairs", 51, 0.95, 1.05)
    hist_DGM_dxyRes_bin1 = r.TH1F("hist_DGM_dxyRes_bin1", ";d_{xy}^{reco}/d_{xy}^{gen};Pairs", 51, 0.95, 1.05)
    hist_DGM_dxyRes_bin2 = r.TH1F("hist_DGM_dxyRes_bin2", ";d_{xy}^{reco}/d_{xy}^{gen};Pairs", 51, 0.95, 1.05)
    hist_DGM_dxyRes_bin3 = r.TH1F("hist_DGM_dxyRes_bin3", ";d_{xy}^{reco}/d_{xy}^{gen};Pairs", 51, 0.95, 1.05)
    hist_SA_ptRes = r.TH1F("hist_SA_ptRes", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 60, 0.0, 2.0)
    hist_RSA_ptRes = r.TH1F("hist_RSA_ptRes", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 60, 0.0, 2.0)
    hist_DSA_ptRes = r.TH1F("hist_DSA_ptRes", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 60, 0.0, 2.0)
    hist_PATGlobal_ptRes = r.TH1F("hist_PATGlobal_ptRes", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 60, 0.0, 2.0)
    hist_PATGlobal_ptRes_zoom = r.TH1F("hist_PATGlobal_ptRes_zoom", ";p_{T}^{reco}/p_{T}^{gen};Pairs", 51, 0.8, 1.2)

    #######################################
    ####   Book distribution objects   ####
    #######################################
    hist_DGM_deltaR_bin1 = r.TH1F("hist_DGM_deltaR_bin1", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, 3.0)
    hist_DGM_deltaR_bin2 = r.TH1F("hist_DGM_deltaR_bin2", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, 3.0)
    hist_DGM_deltaR_bin3 = r.TH1F("hist_DGM_deltaR_bin3", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, 3.0)
    hist_DGM_deltaPhi_bin1 = r.TH1F("hist_DGM_deltaPhi_bin1", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, math.pi)
    hist_DGM_deltaPhi_bin2 = r.TH1F("hist_DGM_deltaPhi_bin2", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, math.pi)
    hist_DGM_deltaPhi_bin3 = r.TH1F("hist_DGM_deltaPhi_bin3", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, math.pi)
    hist_DGM_alpha_bin1 = r.TH1F("hist_DGM_alpha_bin1", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, math.pi)
    hist_DGM_alpha_bin2 = r.TH1F("hist_DGM_alpha_bin2", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, math.pi)
    hist_DGM_alpha_bin3 = r.TH1F("hist_DGM_alpha_bin3", ";Generated #DeltaR(#mu#mu);Pairs", 60, 0.0, math.pi)


    hist_IFCA_deltaR = r.TH1F("hist_IFCA_deltaR", ";p_{T}^{reco}/p_{T}^{gen};PDF", 60, 0.0, 0.5)
    hist_DGM_deltaR = r.TH1F("hist_DGM_deltaR", ";p_{T}^{reco}/p_{T}^{gen};PDF", 60, 0.0, 0.5)
    hist_SA_deltaR = r.TH1F("hist_SA_deltaR", ";p_{T}^{reco}/p_{T}^{gen};PDF", 60, 0.0, 0.5)
    hist_RSA_deltaR = r.TH1F("hist_RSA_deltaR", ";p_{T}^{reco}/p_{T}^{gen};PDF", 60, 0.0, 0.5)
    hist_DSA_deltaR = r.TH1F("hist_DSA_deltaR", ";p_{T}^{reco}/p_{T}^{gen};PDF", 60, 0.0, 0.5)

    hist_GenLeptonPair_lldR = r.TH1F("hist_GenLeptonPair_lldR", ";#Delta R;Muons", 10, 0.0, 1.0)

    hist2D_genLxy_gendxy = r.TH2F("hist2D_genLxy_gendxy", ";Generated L_{xy} (cm);Generated dxy (cm)", 20, 0, 100, 20, 0, 100)
    hist_gen_Lxy = r.TH1F("hist_gen_Lxy", ";Generated L_{xy};PDF", 60, 0, 1000)

    

    #################################
    ####   Book TFakes objects   ####
    #################################
    prof_DGM_ptRes = r.TProfile("prof_DGM_ptRes", ";Generated #mu L_{xy} (cm); <p_{T}^{reco}/p_{T}^{gen}>", len(Lxy_profbin)-1, Lxy_profbin, 0.8, 1.2)
    prof_DGM_dxyRes = r.TProfile("prof_DGM_dxyRes", ";Generated #mu L_{xy} (cm); <d_{xy}^{reco}/d_{xy}^{gen}>", len(Lxy_profbin)-1, Lxy_profbin, 0.9, 1.1)


    #########################
    ####   Load sample   ####
    #########################
    _sampleName = opts.filename
    _file = TFile(_sampleName)
    _tree = _file.Get("Events")
    print("TTree with " + str(_tree.GetEntries()) + " entries")


    ###################################
    ####   Loop over tree events   ####
    ###################################

    for i in range(0, _tree.GetEntries()):

        _tree.GetEntry(i)
        #if i > 5000: break

        ### Muon Channel
        #if _tree.Flag_HLT_L2DoubleMu28_NoVertex_2Cha_Angle2p5_Mass10 == 1:
        if True:

            for j in range(0, _tree.nGenLepton):
                
                if not _tree.GenLeptonSel_isPromptFinalState[j]: continue
                if abs(_tree.GenLeptonSel_pdgId[j]) != 13: continue
                if abs(_tree.GenLeptonSel_eta[j]) > 2.0: continue #2.4 antes
                if _tree.GenLeptonSel_pt[j] < 20: continue

                #Lxy = math.sqrt((_tree.GenLeptonSel_vx[j]-_tree.PV_vx)**2 + (_tree.GenLeptonSel_vy[j]-_tree.PV_vy)**2)
                Lxy = math.sqrt((_tree.GenLeptonSel_vx[j])**2 + (_tree.GenLeptonSel_vy[j])**2)
                Lxy = math.sqrt(_tree.GenLeptonSel_vx[j]**2 + _tree.GenLeptonSel_vy[j]**2)
                pt = _tree.GenLeptonSel_pt[j]
                eta = _tree.GenLeptonSel_eta[j]
                phi = _tree.GenLeptonSel_phi[j]
                dxy = abs(_tree.GenLeptonSel_dxy[j])
                if dxy < 0.0000000000000001: continue # protection to about float division by zero

                hist2D_genLxy_gendxy.Fill(Lxy, dxy)

                hist_gen_Lxy.Fill(Lxy)

                l = TVector3()
                l.SetPtEtaPhi(pt, eta, phi)

                ## Compute the deltaR with the other muon
                ll = TVector3()
                partner = False
                for jj in range(0, _tree.nGenLepton):
                    if jj == j: continue
                    if _tree.GenLeptonSel_vx[j] == _tree.GenLeptonSel_vx[jj] and _tree.GenLeptonSel_vy[j] == _tree.GenLeptonSel_vy[jj]:
                        ll.SetPtEtaPhi(_tree.GenLeptonSel_pt[jj], _tree.GenLeptonSel_eta[jj], _tree.GenLeptonSel_phi[jj])
                        partner = True
                        break

                if not partner: continue
                lldR = l.DeltaR(ll)
                lldPhi = l.DeltaPhi(ll)
                llalpha = l.Angle(ll)
                hist_GenLeptonPair_lldR.Fill(lldR)


                ################
                ## IFCA muons ##
                ################
                deltaR = 9999.0
                index = -9
                for k in range(0, _tree.nMuonCandidate):
                    if abs(_tree.MuonCandidate_eta[k]) > 2: continue
                    if _tree.MuonCandidate_pt[k] < 31: continue
                    re = TVector3()
                    re.SetPtEtaPhi(_tree.MuonCandidate_pt[k], _tree.MuonCandidate_eta[k], _tree.MuonCandidate_phi[k])
                    if re.DeltaR(l) < 0.3:
                        deltaR = re.DeltaR(l)
                        index = k

                if deltaR < MAX_DELTAR:
                    eff_IFCA_pt.Fill(True, pt)
                    eff_IFCA_eta.Fill(True, eta)
                    eff_IFCA_Lxy.Fill(True, Lxy)
                    hist_IFCA_ptRes.Fill((_tree.MuonCandidate_pt[index])/pt)
                    hist_IFCA_deltaR.Fill(re.DeltaR(l))
                else:
                    eff_IFCA_pt.Fill(False, pt)
                    eff_IFCA_eta.Fill(False, eta)
                    eff_IFCA_Lxy.Fill(False, Lxy)

                ##############
                ## SA muons ##
                ##############
                deltaR = 9999.0
                index = -9
                for k in range(0, _tree.nSA):
                    #if (_tree.SA_pt[k] < 31): continue
                    #if (abs(_tree.SA_eta[k]) > 2.0): continue
                    re = TVector3()
                    re.SetPtEtaPhi(_tree.SA_pt[k], _tree.SA_eta[k], _tree.SA_phi[k])
                    if re.DeltaR(l) < deltaR:
                        deltaR = re.DeltaR(l)
                        index = k

                #    print("ONE SA: ", _tree.SA_pt[k], _tree.SA_eta[k], _tree.SA_phi[k])

                if deltaR < MAX_DELTAR:
                    hist_SA_ptRes.Fill((_tree.SA_pt[index])/pt)
                    hist_SA_deltaR.Fill(deltaR)
                    eff_SA_pt.Fill(True, pt)
                    eff_SA_eta.Fill(True, eta)
                    eff_SA_Lxy.Fill(True, Lxy)
                    eff_SA_Lxy_log.Fill(True, Lxy)
                    eff_SA_dxy.Fill(True, dxy)
                    eff_SA_ptVSLxy.Fill(True, Lxy, pt)
                    eff_SA_dR.Fill(True, lldR)
                else:
                    eff_SA_pt.Fill(False, pt)
                    eff_SA_eta.Fill(False, eta)
                    eff_SA_Lxy.Fill(False, Lxy)
                    eff_SA_Lxy_log.Fill(False, Lxy)
                    eff_SA_dxy.Fill(False, dxy)
                    eff_SA_ptVSLxy.Fill(False, Lxy, pt)
                    eff_SA_dR.Fill(False, lldR)

                #print("Matched? :", deltaR < MAX_DELTAR, deltaR)

                ###############
                ## DSA muons ##
                ###############
                deltaR = 9999.0
                index = -9
                for k in range(0, _tree.nDSA):
                    #if (_tree.DSA_pt[k] < 31): continue
                    #if (abs(_tree.DSA_eta[k]) > 2.0): continue
                    re = TVector3()
                    re.SetPtEtaPhi(_tree.DSA_pt[k], _tree.DSA_eta[k], _tree.DSA_phi[k])
                    if re.DeltaR(l) < deltaR:
                        deltaR = re.DeltaR(l)
                        index = k

                    #print("ONE DSA: ", _tree.DSA_pt[k], _tree.DSA_eta[k], _tree.DSA_phi[k])

                if deltaR < MAX_DELTAR:
                    hist_DSA_ptRes.Fill((_tree.DSA_pt[index])/pt)
                    hist_DSA_deltaR.Fill(deltaR)
                    eff_DSA_pt.Fill(True, pt)
                    eff_DSA_eta.Fill(True, eta)
                    eff_DSA_Lxy.Fill(True, Lxy)
                    eff_DSA_Lxy_log.Fill(True, Lxy)
                    eff_DSA_dxy.Fill(True, dxy)
                    eff_DSA_ptVSLxy.Fill(True, Lxy, pt)
                    eff_DSA_dR.Fill(True, lldR)
                else:
                    eff_DSA_pt.Fill(False, pt)
                    eff_DSA_eta.Fill(False, eta)
                    eff_DSA_Lxy.Fill(False, Lxy)
                    eff_DSA_Lxy_log.Fill(False, Lxy)
                    eff_DSA_dxy.Fill(False, dxy)
                    eff_DSA_ptVSLxy.Fill(False, Lxy, pt)
                    eff_DSA_dR.Fill(False, lldR)

                #print("Matched? :", deltaR < MAX_DELTAR, deltaR)


                ###############
                ## DGM muons ##
                ###############
                deltaR = 9999.0
                index = -9
                for k in range(0, _tree.nDGM):
                    #if abs(_tree.DGM_eta[k]) > 2: continue
                    #if _tree.DGM_pt[k] < 31: continue
                    re = TVector3()
                    re.SetPtEtaPhi(_tree.DGM_pt[k], _tree.DGM_eta[k], _tree.DGM_phi[k])
                    if re.DeltaR(l) < deltaR:
                        deltaR = re.DeltaR(l)
                        index = k

                if deltaR < MAX_DELTAR:
                    eff_DGM_pt.Fill(True, pt)
                    eff_DGM_eta.Fill(True, eta)
                    eff_DGM_Lxy.Fill(True, Lxy)
                    eff_DGM_Lxy_log.Fill(True, Lxy)
                    eff_DGM_dxy.Fill(True, dxy)
                    hist_DGM_ptRes.Fill((_tree.DGM_pt[index])/pt)
                    hist_DGM_ptRes_zoom.Fill((_tree.DGM_pt[index])/pt)
                    hist_DGM_dxyRes_zoom.Fill((abs(_tree.DGM_dxy[index]))/dxy)
                    prof_DGM_ptRes.Fill(Lxy, (_tree.DGM_pt[index])/pt)
                    prof_DGM_dxyRes.Fill(Lxy, (_tree.DGM_dxy[index])/dxy)

                    # Displacement bins:
                    if Lxy < 5: 
                        hist_DGM_ptRes_bin1.Fill((_tree.DGM_pt[index])/pt)
                        hist_DGM_dxyRes_bin1.Fill((abs(_tree.DGM_dxy[index]))/dxy)
                        hist_DGM_deltaR_bin1.Fill(lldR)
                        hist_DGM_deltaPhi_bin1.Fill(lldPhi)
                        hist_DGM_alpha_bin1.Fill(llalpha)
                    elif Lxy >= 5 and Lxy < 30: 
                        hist_DGM_ptRes_bin2.Fill((_tree.DGM_pt[index])/pt)
                        hist_DGM_dxyRes_bin2.Fill((abs(_tree.DGM_dxy[index]))/dxy)
                        hist_DGM_deltaR_bin2.Fill(lldR)
                        hist_DGM_deltaPhi_bin2.Fill(lldPhi)
                        hist_DGM_alpha_bin2.Fill(llalpha)
                    else:
                        hist_DGM_ptRes_bin3.Fill((_tree.DGM_pt[index])/pt)
                        hist_DGM_dxyRes_bin3.Fill((abs(_tree.DGM_dxy[index]))/dxy)
                        hist_DGM_deltaR_bin3.Fill(lldR)
                        hist_DGM_deltaPhi_bin3.Fill(lldPhi)
                        hist_DGM_alpha_bin3.Fill(llalpha)


                else:
                    eff_DGM_pt.Fill(False, pt)
                    eff_DGM_eta.Fill(False, eta)
                    eff_DGM_Lxy.Fill(False, Lxy)
                    eff_DGM_Lxy_log.Fill(False, Lxy)
                    eff_DGM_dxy.Fill(False, dxy)


                ######################
                ## PAT Global muons ##
                ######################
                deltaR = 9999.0
                index = -9
                for k in range(0, _tree.nMuon):
                #    if abs(_tree.GM_eta[k]) > 2: continue
                #    if _tree.GM_pt[k] < 31: continue
                    if not _tree.MuonSel_isGlobalMuon[k]: continue

                    re = TVector3()
                    re.SetPtEtaPhi(_tree.MuonSel_pt[k], _tree.MuonSel_eta[k], _tree.MuonSel_phi[k])
                    if re.DeltaR(l) < deltaR:
                        deltaR = re.DeltaR(l)
                        index = k

                if deltaR < MAX_DELTAR:
                    eff_PATGlobal_pt.Fill(True, pt)
                    eff_PATGlobal_eta.Fill(True, eta)
                    eff_PATGlobal_Lxy.Fill(True, Lxy)
                    eff_PATGlobal_dxy.Fill(True, dxy)
                    eff_PATGlobal_Lxy_log.Fill(True, Lxy)
                    hist_PATGlobal_ptRes.Fill((_tree.MuonSel_pt[index])/pt)
                    hist_PATGlobal_ptRes_zoom.Fill((_tree.MuonSel_pt[index])/pt)
                else:
                    eff_PATGlobal_pt.Fill(False, pt)
                    eff_PATGlobal_eta.Fill(False, eta)
                    eff_PATGlobal_Lxy.Fill(False, Lxy)
                    eff_PATGlobal_dxy.Fill(False, dxy)
                    eff_PATGlobal_Lxy_log.Fill(False, Lxy)



    if not os.path.exists(WORKPATH + 'efficiencies_'+opts.tag+'/'): os.makedirs(WORKPATH + 'efficiencies_'+opts.tag+'/')
    outputFile = TFile(WORKPATH +'efficiencies_'+ opts.tag + '/MuonEfficiencies.root', 'RECREATE')



    #### Write everything to use later:
    eff_IFCA_pt.Write()
    eff_IFCA_eta.Write()
    eff_IFCA_Lxy.Write()
    eff_SA_pt.Write()
    eff_SA_eta.Write()
    eff_SA_Lxy.Write()
    eff_DSA_pt.Write()
    eff_DSA_eta.Write()
    eff_DSA_Lxy.Write()
    eff_PATGlobal_pt.Write()
    eff_PATGlobal_eta.Write()
    eff_PATGlobal_Lxy.Write()
    eff_DGM_pt.Write()
    eff_DGM_eta.Write()
    eff_DGM_Lxy.Write()
    eff_SA_ptVSLxy.Write()
    eff_RSA_ptVSLxy.Write()
    eff_DSA_ptVSLxy.Write()
    hist_DGM_ptRes.Write()
    hist_DGM_ptRes_zoom.Write()
    hist_DGM_dxyRes_zoom.Write()
    prof_DGM_ptRes.Write()
    prof_DGM_dxyRes.Write()
    hist_DGM_ptRes_bin1.Write()
    hist_DGM_dxyRes_bin1.Write()
    hist_DGM_deltaR_bin1.Write()
    hist_DGM_deltaPhi_bin1.Write()
    hist_DGM_alpha_bin1.Write()
    hist_DGM_ptRes_bin2.Write()
    hist_DGM_dxyRes_bin2.Write()
    hist_DGM_deltaR_bin2.Write()
    hist_DGM_deltaPhi_bin2.Write()
    hist_DGM_alpha_bin2.Write()
    hist_DGM_ptRes_bin3.Write()
    hist_DGM_dxyRes_bin3.Write()
    hist_DGM_deltaR_bin3.Write()
    hist_DGM_deltaPhi_bin3.Write()
    hist_DGM_alpha_bin3.Write()
    hist2D_genLxy_gendxy.Write()
    hist_gen_Lxy.Write()

    outputFile.Close()

    #### Plot some of the efficiencies:
    """
    EFF_algoVSpt = Canvas.Canvas('EFF_algoVSpt', 'png', 0.5, 0.84, 0.9, 0.89, 4)
    EFF_algoVSpt.addRate(eff_IFCA_pt, 'AP', 'IFCA', 'p', r.kMagenta-4, True, 0, marker = 22)
    EFF_algoVSpt.addRate(eff_DGM_pt, 'AP, same', 'DGM', 'p', r.kAzure-3, True, 1, marker = 20)
    EFF_algoVSpt.addRate(eff_SA_pt, 'AP, same', 'SA', 'p', r.kGreen-2, True, 2, marker = 21)
    EFF_algoVSpt.addRate(eff_DSA_pt, 'AP, same', 'DSA', 'p', r.kRed+1, True, 3, marker = 34)
    EFF_algoVSpt.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/')
    """

    EFF_algoVSLxy = Canvas.Canvas('EFF_algoVSLxy', 'png', 0.15, 0.15, 0.40, 0.30, 1)
    EFF_algoVSLxy.addRate(eff_PATGlobal_Lxy, 'AP, same', 'PAT Global', 'p', r.kBlue-7, True, 0, marker = 21)
    EFF_algoVSLxy.addRate(eff_DGM_Lxy, 'AP, same', 'Displaced Global', 'p', r.kBlue+2, True, 1, marker = 20)
    EFF_algoVSLxy.addRate(eff_SA_Lxy, 'AP, same', 'StandAlone', 'p', r.kRed-7, True, 2, marker = 21)
    EFF_algoVSLxy.addRate(eff_DSA_Lxy, 'AP, same', 'Displaced StandAlone', 'p', r.kRed+2, True, 3, marker = 20)
    EFF_algoVSLxy.addLatex(0.88, 0.87, 'H#rightarrowXX#rightarrow4l,   p_{T} > 20 GeV, |#eta| < 2', size = 0.03, align = 31)
    EFF_algoVSLxy.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/', xlog = False)

    EFF_algoVSLxy_log = Canvas.Canvas('EFF_algoVSLxy_log', 'png', 0.15, 0.15, 0.40, 0.30, 1)
    EFF_algoVSLxy_log.addRate(eff_PATGlobal_Lxy_log, 'AP, same', 'PAT Global', 'p', r.kBlue-7, True, 0, marker = 21)
    EFF_algoVSLxy_log.addRate(eff_DGM_Lxy_log, 'AP, same', 'Displaced Global', 'p', r.kBlue+2, True, 1, marker = 20)
    EFF_algoVSLxy_log.addRate(eff_SA_Lxy_log, 'AP, same', 'StandAlone', 'p', r.kRed-7, True, 2, marker = 21)
    EFF_algoVSLxy_log.addRate(eff_DSA_Lxy_log, 'AP, same', 'Displaced StandAlone', 'p', r.kRed+2, True, 3, marker = 20)
    EFF_algoVSLxy_log.addLatex(0.88, 0.87, 'H#rightarrowXX#rightarrow4l,   p_{T} > 20 GeV, |#eta| < 2', size = 0.03, align = 31)
    EFF_algoVSLxy_log.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/', xlog = True)

    EFF_algoVSdxy = Canvas.Canvas('EFF_algoVSdxy', 'png', 0.53, 0.43, 0.83, 0.57, 1)
    EFF_algoVSdxy.addRate(eff_PATGlobal_dxy, 'AP, same', 'PAT Global', 'p', r.kBlue-7, True, 0, marker = 21)
    EFF_algoVSdxy.addRate(eff_DGM_dxy, 'AP, same', 'Displaced Global', 'p', r.kBlue+2, True, 1, marker = 20)
    EFF_algoVSdxy.addRate(eff_SA_dxy, 'AP, same', 'StandAlone', 'p', r.kRed-7, True, 2, marker = 21)
    EFF_algoVSdxy.addRate(eff_DSA_dxy, 'AP, same', 'Displaced StandAlone', 'p', r.kRed+2, True, 3, marker = 20)
    EFF_algoVSdxy.addLatex(0.88, 0.87, 'H#rightarrowXX#rightarrow4l,   p_{T} > 20 GeV, |#eta| < 2', size = 0.03, align = 31)
    EFF_algoVSdxy.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/', xlog = False)

    """
    FAKE_algoVSdxy = Canvas.Canvas('FAKE_algoVSdxy', 'png', 0.5, 0.84, 0.9, 0.89, 4)
    FAKE_algoVSdxy.addRate(fake_IFCA_dxy, 'AP', 'IFCA', 'p', r.kMagenta-4, True, 0, marker = 22)
    FAKE_algoVSdxy.addRate(fake_DGM_dxy, 'AP, same', 'DGM', 'p', r.kAzure-3, True, 1, marker = 20)
    FAKE_algoVSdxy.addRate(fake_SA_dxy, 'AP, same', 'SA', 'p', r.kGreen-2, True, 2, marker = 21)
    FAKE_algoVSdxy.addRate(fake_DSA_dxy, 'AP, same', 'DSA', 'p', r.kRed+1, True, 3, marker = 34)
    FAKE_algoVSdxy.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/', xlog = False)

    FAKE_algoVSpt = Canvas.Canvas('FAKE_algoVSpt', 'png', 0.5, 0.84, 0.9, 0.89, 4)
    FAKE_algoVSpt.addRate(fake_IFCA_pt, 'AP', 'IFCA', 'p', r.kMagenta-4, True, 0, marker = 22)
    FAKE_algoVSpt.addRate(fake_DGM_pt, 'AP, same', 'DGM', 'p', r.kAzure-3, True, 1, marker = 20)
    FAKE_algoVSpt.addRate(fake_SA_pt, 'AP, same', 'SA', 'p', r.kGreen-2, True, 2, marker = 21)
    FAKE_algoVSpt.addRate(fake_DSA_pt, 'AP, same', 'DSA', 'p', r.kRed+1, True, 3, marker = 34)
    FAKE_algoVSpt.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/', xlog = False)

    EFF_algoVSdxy = Canvas.Canvas('EFF_algoVSdxy', 'png', 0.5, 0.84, 0.9, 0.89, 4)
    EFF_algoVSdxy.addRate(eff_DGM_dxy, 'AP, same', 'DGM', 'p', r.kAzure-3, True, 1, marker = 20)
    EFF_algoVSdxy.addRate(eff_SA_dxy, 'AP, same', 'SA', 'p', r.kGreen-2, True, 2, marker = 21)
    EFF_algoVSdxy.addRate(eff_DSA_dxy, 'AP, same', 'DSA', 'p', r.kRed+1, True, 3, marker = 34)
    EFF_algoVSdxy.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/', xlog = False)

    EFF_algoVSdR = Canvas.Canvas('EFF_algoVSdR', 'png', 0.55, 0.80, 0.9, 0.89, 3)
    EFF_algoVSdR.addRate(eff_SA_dR, 'AP, same', 'SA', 'p', r.kRed-7, True, 1, marker = 34)
    EFF_algoVSdR.addRate(eff_DSA_dR, 'AP, same', 'DSA', 'p', r.kRed+1, True, 1, marker = 34)
    EFF_algoVSdR.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/')
    """

    """
    c1 = r.TCanvas()
    eff_SA_ptVSLxy.Draw("colz, text")
    c1.SaveAs(WORKPATH + 'efficiencies_'+opts.tag+'/' + 'eff_SA_ptVSLxy.png')
    eff_RSA_ptVSLxy.Draw("colz, text")
    c1.SaveAs(WORKPATH + 'efficiencies_'+opts.tag+'/' + 'eff_RSA_ptVSLxy.png')
    eff_DSA_ptVSLxy.Draw("colz, text")
    c1.SaveAs(WORKPATH + 'efficiencies_'+opts.tag+'/' + 'eff_DSA_ptVSLxy.png')
    """

    hist_PATGlobal_ptRes.Scale(1.0/hist_PATGlobal_ptRes.Integral())
    hist_DGM_ptRes.Scale(1.0/hist_DGM_ptRes.Integral())
    hist_SA_ptRes.Scale(1.0/hist_SA_ptRes.Integral())
    hist_DSA_ptRes.Scale(1.0/hist_DSA_ptRes.Integral())
    hist_PATGlobal_ptRes.SetMaximum(0.45)

    print(hist_PATGlobal_ptRes.Integral())
    print(hist_DGM_ptRes.Integral())

    hist_PATGlobal_ptRes.SetLineWidth(2)
    hist_DGM_ptRes.SetLineWidth(2)
    hist_SA_ptRes.SetLineWidth(2)
    hist_DSA_ptRes.SetLineWidth(2)

    HIST_ptRes = Canvas.Canvas("hist_ptRes", 'png', 0.53, 0.75, 0.88, 0.9, 1)
    HIST_ptRes.addHisto(hist_PATGlobal_ptRes, 'HIST', 'PAT Global', 'l', r.kBlue-7, 1, 0)
    HIST_ptRes.addHisto(hist_DGM_ptRes, 'HIST, SAME', 'Displaced Global', 'l', r.kBlue+2, 1, 1)
    HIST_ptRes.addHisto(hist_SA_ptRes, 'HIST, SAME', 'StandAlone', 'l', r.kRed-7, 1, 2)
    HIST_ptRes.addHisto(hist_DSA_ptRes, 'HIST, SAME', 'Displaced StandAlone', 'l', r.kRed+2, 1, 3)
    HIST_ptRes.addLatex(0.9, 0.94, 'H#rightarrowXX#rightarrow4l,   p_{T} > 20 GeV, |#eta| < 2', size = 0.03, align = 31)
    HIST_ptRes.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/')
    

    hist_PATGlobal_ptRes_zoom.Scale(1.0/hist_PATGlobal_ptRes_zoom.Integral())
    hist_DGM_ptRes_zoom.Scale(1.0/hist_DGM_ptRes_zoom.Integral())
    hist_PATGlobal_ptRes_zoom.SetLineWidth(2)
    hist_DGM_ptRes_zoom.SetLineWidth(2)

    HIST_ptRes_zoom = Canvas.Canvas("hist_ptRes", 'png', 0.58, 0.82, 0.88, 0.9, 1)
    HIST_ptRes_zoom.addHisto(hist_PATGlobal_ptRes_zoom, 'HIST', 'PAT Global', 'l', r.kBlue-7, 1, 0)
    HIST_ptRes_zoom.addHisto(hist_DGM_ptRes_zoom, 'HIST, SAME', 'Displaced Global', 'l', r.kBlue+2, 1, 1)
    HIST_ptRes_zoom.addLatex(0.9, 0.94, 'H#rightarrowXX#rightarrow4l,   p_{T} > 20 GeV, |#eta| < 2', size = 0.03, align = 31)
    HIST_ptRes_zoom.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/')
    """
    HIST_muonDeltaR= Canvas.Canvas("hist_muonDeltaR", 'png', 0.55, 0.80, 0.9, 0.89, 3)
    HIST_muonDeltaR.addHisto(hist_GenLeptonPair_lldR, 'HIST', 'gen #mu', 'l', r.kRed+1, 1, 2)
    HIST_muonDeltaR.save(1, 0, 0, '', '', outputDir = WORKPATH + 'efficiencies_'+opts.tag+'/')
    """

